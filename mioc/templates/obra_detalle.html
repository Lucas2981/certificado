{% extends 'layouts/base.html' %}
{% block content %}
{% block title %}Detalle de Obras{% endblock %}
{% load crispy_forms_tags %}
{% load humanize %}

<main class="container py-5">
    <h1 class="display-3 text-center fw-medium">Detalle de Obras</h1>
    <br>
    <div class="accordion accordion-flush" id="accordionFlushExample">
        <!-- inicio item -->
        {% for x in obra %}
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#flush-collapse{{ x.id }}" aria-expanded="false" aria-controls="flush-collapse{{ x.id }}">
                    <b>{{ forloop.counter }}</b> - {{ x.obra.codObra }} - {{ x.obra.institucion.name }}
                </button>
            </h2>
            <div id="flush-collapse{{ x.id }}" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                <div class="accordion-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p>Carátula: <b>{{ x.obra.nombre_obra }}</b></p>
                            <p>Tipo de obra: <b>{{ x.obra.institucion.clase.name }} - {{ x.obra.institucion.clase.subname }}</b></p>
                            <p>Departamento: <b>{{ x.obra.institucion.location.NOMDEPTO }} (Cod. Indec {{ x.obra.institucion.location.CODDEPTO }})</b></p>
                            <p>Municipio: <b>{{ x.obra.institucion.location.NOMMUNI }} (Cod. Indec {{ x.obra.institucion.location.CODMUNI }})</b></p>
                            <p>Localidad: <b>{{ x.obra.institucion.location.NOMLOC }} (Cod. Indec {{ x.obra.institucion.location.CODLOC }})</b></p>
                            <p>Empresa Constructora: <b>{{ x.obra.empresa }}</b> </p>
                            <p> > Representante Técnico: {{ x.obra.empresa.representante_tecnico }}</p>
                            <p> > Propietario: {{ x.obra.empresa.propietario }}</p>
                            <p> > Contacto: {{ x.obra.empresa.email }} - {{ x.obra.empresa.telephone }}</p>
                            <p>Fecha de inicio: <b>{{ x.obra.inicio }}</b></p>
                            <p>Fecha de entrega: <b>{{ x.obra.vencimiento_contractual }}</b></p>
                            <p>Monto de contrato ($): <b>{{ x.obra.monto_contrato|intcomma  }}</b></p>
                            <p>Monto de contrato (UVIS): <b>{{ x.obra.monto_uvi|intcomma }}</b></p>
                            <figure class="figure">
                                <img src= "{{ x.imagen }}"
                                    class="figure-img img-fluid rounded" alt="MIOC">
                                <figcaption class="figure-caption">Puente 3era etapa.</figcaption>
                            </figure>
                            <p class="text-center"><span class="badge text-bg-primary">Avance esperado</span><span
                                    class="badge text-bg-success">Avance real</span></p>
                            <div class="progress" role="progressbar" aria-label="Primary example" aria-valuenow="45"
                                aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-bar bg-primary" style="width: 45%">45%</div>
                            </div>
                            <br>
                            <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="50"
                                aria-valuemin="0" aria-valuemax="100">
                                <div class="progress-bar bg-success" style="width: 50%">50%</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <p class="textarea" style="white-space: pre-wrap;">{{ x.resumen }}</p>
                            <span><i>Resumido por: <b>{{ x.user }}</b></i></span>
                            
                        </div>
                    </div>
                    <br>
                </div>
            </div>
        </div>
        {% endfor %}
        <!-- final item -->
    </div>
    <br>
    <h1>Detalles de la obra {{ obras.name }}</h1>
    
    <table class="table table-striped table-bordered">
        <tr>
            <th>Tipos de documentos</th>
            <th>Codigo</th>
            <th>Obra</th>
        </tr>
        {% for memoria in memoria %}
        <tr>
            <td>Memoria</td>
            <td>{{ memoria.codMem }}</td>
            <td>{{ memoria.obra.institucion.name }}</td>
        </tr>
        {% endfor %}
        {% for certificado in certificados %}
        <tr>
            <td>Certificado</td>
            <td>{{ certificado.nro_cert }}</td>
            <td>{{ certificado.obra.institucion.name }}</td>
        </tr>
        {% endfor %}
    </table>
    {{ error }}
</main>
{% endblock %}